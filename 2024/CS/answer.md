# 2024 简答题

## 数组和结构的区别与联系

**区别**：

1. **元素类型**：数组中的元素必须是同一类型；结构体中的成员可以是不同类型。
2. **内存分配**：数组元素在内存中连续存储；结构体成员的内存布局可能因对齐规则存在间隙。
3. **访问方式**：数组通过下标访问元素（如 `arr[0]`）；结构体通过成员名访问（如 `s.member`）。
4. **赋值操作**：数组不能直接整体赋值（需逐元素操作）；结构体可以直接整体赋值（C99后支持）。

**联系**：

1. **复合数据类型**：二者均用于组织多个数据，可嵌套使用（如结构体包含数组，或数组元素为结构体）。
2. **内存连续性**：结构体的成员在内存中按声明顺序存储，类似数组的连续性（但可能存在对齐填充）。

## 判断含义

```c
int *p[];

int (*p)[];

int *p();

int (*p)();
```

1. **`int *p[];`**
   - **含义**：`p` 是一个数组，元素类型为 `int*`（指针数组）。
   - 例如：`int *p[5]` 表示长度为5的数组，每个元素指向 `int`。

2. **`int (*p)[];`**
   - **含义**：`p` 是一个指针，指向一个 `int` 类型的数组（数组指针）。
   - 例如：`int (*p)[3]` 表示 `p` 指向长度为3的 `int` 数组。

3. **`int *p();`**
   - **含义**：`p` 是一个函数，返回值类型为 `int*`（函数返回指针）。
   - 例如：`int *p()` 定义了一个返回 `int` 指针的函数。

4. **`int (*p)();`**
   - **含义**：`p` 是一个指针，指向一个返回 `int` 的函数（函数指针）。
   - 例如：`int (*p)(int)` 表示 `p` 指向接受一个 `int` 参数并返回 `int` 的函数。

## 改错题

```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

void main()
{
    char *src = "hello,world";
    char *dest, *d, *p;
    int len, i;

    len = strlen(src); // strlen 返回的是真实字符串长度，不包含 '\0'
    dest = (char*)malloc(len); // 修正：分配足够的内存 -> len + 1 以容纳字符串结尾的 '\0'
    p = src[len]; // 修正：使 p 指向 src 的最后一个字符 -> len - 1
    d = dest;

    while (len-- != 0)
        d++ = p--; // 修正：正确地将 src 的字符逆序复制到 dest -> *(d++) = *(p--)

    // 补充：添加字符串结尾必须的 '\0' -> *d = '\0';
    printf("%s", dest);
}
```

## 静态变量和全局变量的区别；静态变量和普通局部变量的区别

### 静态变量与全局变量

1. **作用域**：
   - 全局变量：整个程序可见（默认具有外部链接，可用 `extern` 跨文件访问）。
   - 静态全局变量：仅在定义它的文件内可见（内部链接）。
2. **初始化**：二者均默认初始化为0（若未显式初始化）。

### 静态变量与普通局部变量

1. **生命周期**：
   - 静态局部变量：程序运行期间始终存在（仅初始化一次）。
   - 普通局部变量：函数调用时创建，退出时销毁。
2. **存储位置**：
   - 静态变量（包括全局和静态局部）存储在静态存储区（`.data` 或 `.bss`）。
   - 普通局部变量存储在栈区。
3. **初始化**：
   - 静态局部变量默认初始化为0；普通局部变量不初始化时值为随机值。
